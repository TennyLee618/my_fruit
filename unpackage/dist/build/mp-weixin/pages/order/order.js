(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"1dac":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("0e00"),o=e("1a1b"),s=console,r=s.log,a=t.getStorageSync("usermen"),c={data:function(){return{tips:"",modaishow:!1,isActive:!0,hasError:!1,ApproveStatus:0,flag:!1,checkFlag:!1,allFlag:"",checkedArr:[],valueNum:0,url:"http://192.168.1.10:8980",orderObj:[],openid:"",neworder:[],isCheck:!1,dataList:[{id:"q2020811",buyNum:1,price:299.5,selected:!1,imgsrc:"../../static/images/putao1.png",shopName:"大葡萄"},{id:"q2020812",buyNum:2,price:499,selected:!1,imgsrc:"../../static/images/niuyouguo1.png",shopName:"大哈密瓜"},{id:"q2020813",buyNum:3,price:199,selected:!1,imgsrc:"../../static/images/putao1.png",shopName:"大紫葡萄"}],isAll:!1,totalPrice:0,buyNum:0,cartIds:[],actions:[{name:"删除",color:"#fff",fontsize:28,width:64,background:"#F82400"}],actions2:[{name:"看相似",color:"#fff",fontsize:28,width:64,background:"#FF7035"},{name:"删除",color:"#fff",fontsize:28,width:64,background:"#F82400"}],isEdit:!1,pageIndex:1,loadding:!1,pullUpOn:!0,allPrice:0}},filters:{getPrice:function(t){return t=t||0,t.toFixed(2)}},methods:{goIndex:function(){t.switchTab({url:"../index/index"})},init:function(t,i){this.modaishow=t,this.tips=i},getUserInfo:function(i){this.usering=i.detail.userInfo,t.setStorageSync("userIN",i.detail.userInfo);t.setStorageSync("userIN",i.detail.userInfo);if(i.detail.userInfo){var e=i.detail.userInfo;this.wxCode(e.avatarUrl,e.nickName)}},wxCode:function(t,i){var e=this;wx.login({success:function(t){var i=t.code;e.wxLoging(i)},fail:function(t){r(t)}})},wxLoging:function(i){var e=this;r(i);var s={code:i};t.showLoading({title:"加载中",icon:"none"}),(0,n.publicing2)(o.loginis,s).then((function(i){500!=i.statusCode?(200==i.statusCode&&r(i),t.setStorageSync("usermen",i.data.token),e.modaishow=!1,e.orderIng(),e.getMerchants(),t.hideLoading()):t.showModal({title:"提示",content:"服务器错误，请重新登录获取信息",success:function(i){(i.confirm||i.cancel)&&t.hideLoading()}})})).catch((function(i){t.showToast({title:"".concat(i)}),r(i)}))},getMerchants:function(){var t=this,i={token:a};(0,n.listing)(o.getClient,i).then((function(i){t.ApproveStatus=i.data.data.approveStatus})).catch((function(t){r(t)}))},jieSuanPrice:function(){var t=0;for(var i in this.orderObj){var e=this.orderObj[i].list;for(var n in e){var o=e[n];-1!=this.cartIds.indexOf(o.id)&&(t+=o.number*o.platformPrice)}}this.allPrice=t.toFixed(2)},orderIng:function(){var i=this,e=t.getStorageSync("usermen"),s={token:e};(0,n.listing)(o.getCart,s).then((function(t){i.orderObj=t.data.data})).catch((function(t){r(t)}))},gotoList:function(i){r(i),t.navigateTo({url:"../../pagesIII/productDetail/productDetail?id="+i})},tising:function(t,i){this.init(t,i)},calcHandle:function(){var t=0,i=0,e=0;this.dataList.map((function(n){n.selected&&(t+=n.buyNum,i+=n.price*n.buyNum,e++)})),this.isAll=e===this.dataList.length,this.buyNum=t,this.totalPrice=i},changeNum:function(i){t.showLoading({}),this.orderObj[i.custom].list[i.index].number=i.value,this.jieSuanPrice();var e={id:this.orderObj[i.custom].list[i.index].id,goodsId:this.orderObj[i.custom].list[i.index].goodsId,number:this.orderObj[i.custom].list[i.index].number,token:a};(0,n.publicing)(o.postUpOrder,e).then((function(i){t.hideLoading()})).catch((function(t){r(t)}))},handlerButton:function(i,e){var s=this;r(i);var a=t.getStorageSync("usermen"),c={id:i,goodsId:e,token:a};(0,n.publicing)(o.postDelOrder,c).then((function(i){t.showToast({title:"".concat(i.data.msg)}),s.orderIng()})).catch((function(i){r(i),t.showToast({title:"删除失败"})}))},editGoods:function(){this.isEdit=!this.isEdit},detail:function(){t.navigateTo({url:"../productDetail/productDetail"})},postSubOrder:function(){if(1==this.ApproveStatus){if(this.cartIds.length<=0)return this.isAll=!1,this.checkFlag=!1,this.flag=!1,void t.showToast({title:"先勾选要结算商品呀！",icon:"none"});console.log(this.cartIds);t.getStorageSync("usermen");var i="";for(var e in this.cartIds)i=i+this.cartIds[e]+",";i=i.substring(0,i.length-1)}else t.showToast({title:"您还没有验证店铺",icon:"none"})},btnPay:function(){if(1==this.ApproveStatus)if(this.cartIds.length<=0)t.showToast({title:"先勾选要结算商品呀！",icon:"none"});else{var i="";for(var e in this.cartIds)i=i+this.cartIds[e]+",";i=i.substring(0,i.length-1),this.orderID=i,t.navigateTo({url:"../../pagesIII/submitOrder/submitOrder?ids="+i})}else t.showToast({title:"您还没有验证店铺",icon:"none"})},buyChange:function(t){var i=this.orderObj.length;this.cartIds=t.detail.value,i===t.detail.value.length&&(this.isAll=!0),0===t.detail.value.length&&(this.isAll=!1),this.jieSuanPrice()},checkAll:function(t){for(var i in r(t),this.isAll=!1,this.flag=!1,t.detail.value&&t.detail.value.length>0?(this.flag=!0,this.$forceUpdate()):t.detail.value&&0===t.detail.value.length&&(this.flag=!1,this.$forceUpdate()),this.cartIds=[],console.log("全选状态======",this.flag),this.orderObj)for(var e in this.orderObj[i].list)this.orderObj[i].list[e].selected=this.flag,this.flag&&this.cartIds.push(this.orderObj[i].list[e].id);this.$forceUpdate(),this.jieSuanPrice()},onclike:function(){this.flag=!1,this.isAll=!1}},watch:{},onShow:function(){setTimeout((function(){this.flag=!1}),100),r(this.flag=!1),this.allPrice=0,this.onclike(),this.isCheck=!1,this.flag=!1,this.cartIds=[],this.getMerchants();var i=t.getStorageSync("usermen");if(i){var e=!1,n="";this.tising(e,n),this.orderIng(),r("显示订单")}else{this.hasError=!0,this.isActive=!1;var o=!0,s="请登录后再查看";this.tising(o,s)}var a=this.orderObj;0!==a.length&&(a.forEach((function(t,i){console.log(t,1),t.list.forEach((function(t,i){console.log(t,1),t&&(t.selected=!1)}))})),this.orderObj=a)},onLoad:function(){this.flag=!1},onPullDownRefresh:function(){t.getStorageSync("usermen");this.orderIng(),console.log("refresh"),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},onNavigationBarButtonTap:function(t){this.isEdit=!this.isEdit;this.isEdit}};i.default=c}).call(this,e("543d")["default"])},6614:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return s})),e.d(i,"a",(function(){return n}));var n={tuiSwipeAction:function(){return e.e("components/tui-swipe-action/tui-swipe-action").then(e.bind(null,"54f9"))},tuiNumberbox:function(){return e.e("components/tui-numberbox/tui-numberbox").then(e.bind(null,"1e66"))},tuiButton:function(){return e.e("components/tui-button/tui-button").then(e.bind(null,"63f9"))}},o=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.orderObj,(function(i,e){var n=t.__get_orig(i),o=t.__map(i.list,(function(i,e){var n=t.__get_orig(i),o=t._f("getPrice")(i.platformPrice);return{$orig:n,f0:o}}));return{$orig:n,l0:o}})));t.$mp.data=Object.assign({},{$root:{l1:e}})},s=[]},"745d":function(t,i,e){"use strict";e.r(i);var n=e("1dac"),o=e.n(n);for(var s in n)"default"!==s&&function(t){e.d(i,t,(function(){return n[t]}))}(s);i["default"]=o.a},"79eb":function(t,i,e){"use strict";var n=e("f5cc"),o=e.n(n);o.a},ad88:function(t,i,e){"use strict";e.r(i);var n=e("6614"),o=e("745d");for(var s in o)"default"!==s&&function(t){e.d(i,t,(function(){return o[t]}))}(s);e("79eb");var r,a=e("f0c5"),c=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);i["default"]=c.exports},ebe7:function(t,i,e){"use strict";(function(t){e("79ad");n(e("66fd"));var i=n(e("ad88"));function n(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},f5cc:function(t,i,e){}},[["ebe7","common/runtime","common/vendor"]]]);